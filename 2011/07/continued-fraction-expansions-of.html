<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Continued fraction expansions of irrational square roots</title>
  <meta name="author" content="Danny Hermes">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="/favicon.png" rel="icon">
  <style type="text/css">
    div.katex-elt {
      text-align: center;
    }
    div.katex-elt > blockquote {
      font-size: x-large;
      overflow-x: auto;
      overflow-y: hidden;
    }
  </style>
  <link href="/theme/css/katex.min.css" rel="stylesheet" type="text/css"/>
  <script src="/theme/js/katex.min.js" type="text/javascript"></script>
  <link href="/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="/theme/js/modernizr-2.0.js"></script>
  <script src="/theme/js/ender.js"></script>
  <script src="/theme/js/octopress.js" type="text/javascript"></script>

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="/">Bossylobster Blog</a></h1>
    <h2>Musings on humor/tech/mathematics/sports from the bossiest lobster</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<form action="//google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>

<ul class="main-navigation">
    <li><a href="/archives.html">All Posts</a></li>
    <li><a href="http://github.com/dhermes/">GitHub Profile</a></li>
    <li><a href="http://math.berkeley.edu/~dhermes/">Berkeley Page</a></li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Continued fraction expansions of irrational square roots</h1>
      <p class="meta"><time datetime="2011-07-18T00:00:00-07:00" pubdate>Jul 18, 2011</time></p>
</header>

  <div class="entry-content"><p>I had no idea (until this Thursday, July 16) that I had never seen a
proof of the fact that the continued fraction expansion of
\(\sqrt{D}\) is periodic whenever \(D\) is not a perfect square.
But have no fear, I found out about something called a <em>reduced
quadratic irrational</em> and now have a proof. Here we go.</p>
<p><strong>Definition</strong>: An irrational root \(\alpha\) of a quadratic equation
with integer coefficients is called <em>reduced</em> if \(\alpha > 1\) and
its conjugate \(\tilde{\alpha}\) satisfies \(-1 \&lt; \tilde{\alpha}
\&lt; 0\). \(\Box\)</p>
<p>Solutions (since assumed real) of such quadratics can be written
as \$\$\alpha = \frac{\sqrt{D} + P}{Q}\$\$ where \(D, P, Q \in
\mathbf{Z}\) and \(D, Q > 0\). It is also possible (though not
required) to ensure that \(Q\) divides \(D - P\^2\). This is
actually a necessary assumption for some of the stuff I do, is
mentioned <a href="http://en.wikipedia.org/wiki/Periodic_continued_fraction#Relation_to_quadratic_irrationals">here</a> and
generally frustrated the heck out of me, so that. As an example for some
enlightenment, notice \$\$\alpha = \frac{2 + \sqrt{7}}{4}\$\$ is
reduced but \(4\) does not divide \(7 - 2\^2\). However, if we write
this as \(\frac{8 + \sqrt{112}}{16}\), we have our desired
condition.</p>
<p><strong>Definition</strong>: We say a reduced quadratic irrational \(\alpha\) is
<em>associated</em> to \(D\) if we can write \$\$\alpha = \frac{P +
\sqrt{D}}{Q}\$\$ and \(Q\) divides \(D - P\^2\). \(\Box\)
<strong>
</strong>
<strong>Lemma 1</strong>: Transforming a reduced irrational root \(\alpha\)
associated to \(D\) into its integer part and fractional part via
\$\$\alpha = \lfloor \alpha \rfloor + \frac{1}{\alpha'},\$\$ the
resulting quadratic irrational \(\alpha'\) is reduced and associated
to \(D\) as well. (This is what one does during continued fraction
expansion, and as I did with \(\sqrt{2}\) during my <a href="http://blog.bossylobster.com/2011/07/continued-fractions-for-greater-good.html">last
post</a>.)</p>
<p><strong>Proof</strong>: Letting \$\$\alpha = \frac{\sqrt{D} + P}{Q}\$\$ and \(X
= \lfloor \alpha \rfloor\), we have \$\$\frac{1}{\alpha'} =
\frac{\sqrt{D} - (QX - P)}{Q}.\$\$</p>
<ul>
<li>Since \(\sqrt{D}\) is irrational, we must have
    \(\frac{1}{\alpha'} > 0\) and since \(\frac{1}{\alpha'}\)
    is the fractional part we know \$\$0 \&lt; \frac{1}{\alpha'} \&lt; 1
    \Rightarrow \alpha' > 1.\$\$ </li>
<li>Transforming \$\$\alpha' = \frac{Q}{\sqrt{D} - (QX - P)}
    \cdot \frac{\sqrt{D} + (QX - P)}{\sqrt{D} + (QX - P)}
    = \frac{\sqrt{D} + (QX - P)}{\frac{1}{Q}\left(D - (QX -
    P)\^2\right)},\$\$ we have \(P' = QX - P\) and \(Q'
    = \frac{1}{Q}\left(D - (QX - P)\^2\right)\) and need to show
    \(Q' \in \mathbf{Z}\). But \(D - (QX - P)\^2 \equiv D - P\^2
    \bmod{Q}\) and since \(\alpha\) is associated to \(D\),
    \(Q\) must divide this quantity, hence \(Q'\) is an integer.</li>
<li>Since \(X = \lfloor\frac{\sqrt{D} + P}{Q}\rfloor\) is an
    integer and \(\alpha\) is irrational, we know \(X \&lt;
    \frac{\sqrt{D} + P}{Q}\) hence \(P' = QX - P \&lt; \sqrt{D}\)
    forcing \(\tilde{\alpha}' \&lt; 0\).</li>
<li>Since \(\alpha > 1\) we know \(X \geq 1 \Leftrightarrow 0
    \leq X - 1\). Thus \begin{align*}\tilde{\alpha} = \frac{P -
    \sqrt{D}}{Q} &amp;\&lt; 0 \leq X - 1 \\ \Rightarrow Q &amp;\&lt; \sqrt{D} +
    (QX - P) \\ \Rightarrow Q(\sqrt{D} - (QX - P)) &amp;\&lt; D - (QX -
    P)\^2 \\ \Rightarrow -\tilde{\alpha}' = \frac{\sqrt{D} - (QX<ul>
<li>P)}{\frac{1}{Q}\left(D - (QX - P)\^2\right)} &amp;\&lt;
1 \end{align*} hence \(\tilde{\alpha}' > -1\) and
\(\alpha'\) is reduced.</li>
</ul>
</li>
<li>Since \(Q' = \frac{1}{Q}\left(D - (P')\^2\right)\), we know
    \$\$D - (P')\^2 \equiv Q Q' \equiv 0 \bmod{Q'}\$\$ hence
    \(\alpha'\) is associated to \(D\).</li>
</ul>
<p><strong><span class="Apple-style-span" style="font-weight: normal;">Thus
\(\alpha'\) is both reduced and associated to \(D\).
\(\Box\)</span></strong>
<strong>
</strong>
<strong>Lemma 2</strong>: There are finitely many reduced quadratic irrationals
associated to a fixed \(D\).</p>
<p><strong>Proof</strong>: As above write an arbitrary reduced irrational as \(\alpha
= \frac{\sqrt{D} + P}{Q}\).  Since \(\alpha > 1\)
and \(\tilde{\alpha} > -1\), we know \(\alpha + \tilde{\alpha}
= \frac{2P}{Q} > 0\) hence with the assumption \(Q > 0\) we have
\(P > 0\). Since \(\tilde{\alpha} \&lt; 0\) we also have \(P \&lt;
\sqrt{D}\). Also, since \(\alpha > 1\) by assumption we have \(Q
\&lt; P + \sqrt{D} \&lt; 2\sqrt{D}\) thus there are finitely many choices
for both \(P\) and \(Q\), forcing finitely many reduced quadratic
irrationals associated to a fixed \(D\) (this amount is strictly
bounded above by \(2D\)). \(\Box\)</p>
<p><strong>Claim</strong>: The continued fraction expansion of \(\sqrt{D}\) is
periodic whenever \(D\) is not a perfect square.</p>
<p><strong>Proof</strong>: We'll use Lemma 1 to establish a series of reduced quadratic
irrationals associated to \(D\) and then use Lemma 2 to assert this
series must repeat (hence be periodic) due to the finite number of such
irrationals.</p>
<p>Write \(a_0 = \lfloor \sqrt{D} \rfloor\) and \(\sqrt{D} = a_0 +
\frac{1}{\alpha_0}\). From here, we will prove</p>
<ul>
<li>\(\alpha_0\) is a reduced quadratic irrational associated to
    \(D\).</li>
<li>By defining \(a_{i+1} = \lfloor \alpha_i \rfloor\) and
    \(\alpha_i = a_{i + 1} + \frac{1}{\alpha_{i +
    1}}\), \(\alpha_{i + 1}\) is also a reduced quadratic
    irrational associated to \(D\) (assuming all \(\alpha\) up
    until \(i\) are as well).</li>
</ul>
<p>Since \(\frac{1}{\alpha_0}\) is the fractional part of the
irrational \(\sqrt{D}\), we have \$\$0 \&lt; \frac{1}{\alpha_0} \&lt; 1
\Rightarrow \alpha_0 > 1.\$\$ By simple algebra, we have
\$\$\alpha_0 = \frac{a_0 + \sqrt{D}}{D - a_0\^2}, \qquad
\tilde{\alpha_0} = \frac{a_0 - \sqrt{D}}{D - a_0\^2}.\$\$ Since
\(a_0\) is the floor, we know \(a_0 - \sqrt{D} \&lt; 0
\Rightarrow \tilde{\alpha_0} \&lt; 0\). Since \(D \in \mathbf{Z}
\Rightarrow \sqrt{D} > 1\) and \(\sqrt{D} > a_0\), we have
\$\$1 \&lt; \sqrt{D} + a_0 \Rightarrow \sqrt{D} - a_0 \&lt; D -
a_0\^2 \Rightarrow a_0 - \sqrt{D} > -(D - a_0\^2) \Rightarrow
\tilde{\alpha_0} > -1.\$\$ Thus \(\alpha_0\) is a reduced
quadratic irrational. Since \(P_0 = a_0\) and \(Q_0 = D - a_0\^2
= D - P_0\^2\), \(Q_0\) clearly divides \(D - P_0\^2\) so
\(\alpha_0\) is associated to \(D\) as well.</p>
<p>Following the recurrence defined, since each \(\alpha_i\) is a
reduced quadratic irrational, each \(a_i \geq 1\). Also, by Lemma 1,
each \(\alpha_{i + 1}\) is reduced and associated to \(D\) since
\(\alpha_0\) is. By Lemma 2, we only have finitely many choices for
these, hence there must be some smallest \(k\) for which \(\alpha_k
= \alpha_0\). Since \(\alpha_{i + 1}\) is determined completely
by \(\alpha_i\) we will then have \(\alpha_{k + j} =
\alpha_j\) for all \(j > 0\), hence the \(\alpha_i\) are
periodic. Similarly, as the \(a_i\) for \(i > 0\) are determined
completely by \(\alpha_{i - 1}\), the \(a_i\) must be periodic as
well, forcing the continued fraction expansion \$\$\sqrt{D} = a_0 +
\cfrac{1}{a_1 + \cfrac{1}{a_2 + \ddots}}\$\$ to be
periodic.\(\Box\)</p>
<p><strong>Update:</strong> I
<a href="http://www.proofwiki.org/wiki/Continued_Fraction_Expansion_of_Irrational_Square_Root">posted this</a>
on</p>
<div style="text-align: center;">
<p><img alt="ProofWiki logo" src="/images/175px-Logo.png" /></p>
</div>
<p><a href="https://profiles.google.com/114760865724135687241" rel="author" style="display: none;">About Bossy Lobster</a></p></div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Danny Hermes (dhermes@bossylobster.com)</span>
  </span>
<time datetime="2011-07-18T00:00:00-07:00" pubdate>Jul 18, 2011</time>  <span class="categories">
    <a class="category" href="/tag/algebra.html">Algebra</a>
    <a class="category" href="/tag/continued-fractions.html">Continued Fractions</a>
    <a class="category" href="/tag/math.html">Math</a>
    <a class="category" href="/tag/quadratic-irrational.html">Quadratic Irrational</a>
    <a class="category" href="/tag/square-root.html">Square Root</a>
  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="/2011/07/continued-fraction-expansions-of.html" data-via="bossylobster" data-counturl="/2011/07/continued-fraction-expansions-of.html" >Tweet</a>
  <div class="g-plusone" data-size="medium"></div>
</div>    </footer>
  </article>

</div>
<aside class="sidebar">
  <section>
    <img src="/images/bossy_lobster_200_alpha.png" alt="" width=""/>
  </section>
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="/2014/09/quantitative-interview-brain-teaser.html">Quantitative Interview Brain Teaser: Computer Assistance</a>
      </li>
      <li class="post">
          <a href="/2014/09/quantitative-brain-teaser-brain-only.html">Quantitative Brain Teaser: Brain Only</a>
      </li>
      <li class="post">
          <a href="/2014/08/math-for-humans-second-attempt.html">Math for Humans, A Second Attempt</a>
      </li>
      <li class="post">
          <a href="/2014/07/bayes-law-primer.html">Bayes' Law Primer</a>
      </li>
      <li class="post">
          <a href="/2014/07/conditional-probabilities-in-thinking.html">Conditional Probabilities in "Thinking Fast and Slow"</a>
      </li>
    </ul>
  </section>




<section>
    <a href="http://twitter.com/bossylobster" class="twitter-follow-button" data-show-count="true">Follow @bossylobster</a>
</section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2011-2014  - Danny Hermes -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>
</body>
</html>